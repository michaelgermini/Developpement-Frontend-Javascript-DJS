name: Notifications

on:
  workflow_run:
    workflows: ["CI/CD Pipeline", "Quality Assurance", "Security Scan"]
    types: [completed]

jobs:
  notify:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion != 'skipped' }}
    steps:
      - name: Generate notification
        run: |
          echo "## Workflow Notification" > notification.md
          echo "" >> notification.md
          echo "**Workflow:** ${{ github.event.workflow_run.name }}" >> notification.md
          echo "**Status:** ${{ github.event.workflow_run.conclusion }}" >> notification.md
          echo "**Triggered by:** ${{ github.event.workflow_run.head_branch }}" >> notification.md
          echo "**Duration:** ${{ github.event.workflow_run.duration }}" >> notification.md
          echo "" >> notification.md
          
          if [ "${{ github.event.workflow_run.conclusion }}" = "success" ]; then
            echo "### âœ… Success" >> notification.md
            echo "All checks passed successfully!" >> notification.md
          elif [ "${{ github.event.workflow_run.conclusion }}" = "failure" ]; then
            echo "### âŒ Failure" >> notification.md
            echo "Some checks failed. Please review the logs." >> notification.md
          else
            echo "### âš ï¸ Cancelled" >> notification.md
            echo "Workflow was cancelled." >> notification.md
          fi
          
          echo "" >> notification.md
          echo "### ðŸ“Š Summary" >> notification.md
          echo "- Repository: ${{ github.repository }}" >> notification.md
          echo "- Run ID: ${{ github.event.workflow_run.id }}" >> notification.md
          echo "- Started: ${{ github.event.workflow_run.created_at }}" >> notification.md
          echo "- Completed: ${{ github.event.workflow_run.updated_at }}" >> notification.md

      - name: Upload notification
        uses: actions/upload-artifact@v3
        with:
          name: workflow-notification
          path: notification.md
          retention-days: 7

  educational-notification:
    runs-on: ubuntu-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    steps:
      - name: Generate educational update notification
        run: |
          echo "## Educational Content Update" > educational-notification.md
          echo "" >> educational-notification.md
          echo "ðŸŽ“ **New Educational Content Available!**" >> educational-notification.md
          echo "" >> educational-notification.md
          echo "### ðŸ“š What's New" >> educational-notification.md
          echo "- Updated learning modules" >> educational-notification.md
          echo "- Enhanced interactive examples" >> educational-notification.md
          echo "- Improved documentation" >> educational-notification.md
          echo "- Bug fixes and improvements" >> educational-notification.md
          echo "" >> educational-notification.md
          echo "### ðŸš€ Access the Project" >> educational-notification.md
          echo "- **Local Development:** \`npm run dev\`" >> educational-notification.md
          echo "- **GitHub Pages:** https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/" >> educational-notification.md
          echo "- **Repository:** https://github.com/${{ github.repository }}" >> educational-notification.md
          echo "" >> educational-notification.md
          echo "### ðŸŽ¯ Learning Modules" >> educational-notification.md
          echo "1. **DOM Manipulation** - Learn to work with the Document Object Model" >> educational-notification.md
          echo "2. **Event Handling** - Master user interactions and events" >> educational-notification.md
          echo "3. **Functional Programming** - Explore modern JavaScript patterns" >> educational-notification.md
          echo "4. **API Integration** - Connect to external data sources" >> educational-notification.md
          echo "5. **2D Graphics** - Create interactive visualizations" >> educational-notification.md
          echo "6. **TypeScript** - Advanced type safety and development" >> educational-notification.md
          echo "" >> educational-notification.md
          echo "### ðŸ¤ Contributing" >> educational-notification.md
          echo "Found a bug or have a suggestion? We welcome contributions!" >> educational-notification.md
          echo "- [Report Issues](https://github.com/${{ github.repository }}/issues)" >> educational-notification.md
          echo "- [Contribute](https://github.com/${{ github.repository }}/blob/main/CONTRIBUTING.md)" >> educational-notification.md
          echo "" >> educational-notification.md
          echo "Happy Learning! ðŸŒ±" >> educational-notification.md

      - name: Upload educational notification
        uses: actions/upload-artifact@v3
        with:
          name: educational-notification
          path: educational-notification.md
          retention-days: 30
